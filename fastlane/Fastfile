# This file contains the fastlane.tools configuration
# You can find the documentation at https://docs.fastlane.tools
#
# For a list of all available actions, check out
#
#     https://docs.fastlane.tools/actions
#
# For a list of all available plugins, check out
#
#     https://docs.fastlane.tools/plugins/available-plugins
#

# Uncomment the line if you want fastlane to automatically update itself
# update_fastlane

default_platform(:mac)

platform :mac do
  desc "archive the app, but do not create a DMG"
  lane :development do
    gym
  end

  desc "archive the app, and create a DMG"
  lane :release do
    gym
    Dir.chdir("..") do
      sh "./BuildTools/create-dmg.sh"
    end
  end

  desc "Bump the version number"
  lane :bumpversion do |options|
    version = increment_version_number(
      bump_type: options[:bump_type] ||= "patch",
    )
    build = increment_build_number(build_number: 1)
    commit_version_bump(
      xcodeproj: "Transitions.xcodeproj",
      message: "Bump version to #{version} (build #{build})"
    )
  end

  desc "Bump the build number"
  lane :bumpbuild do
    version = get_version_number
    build = increment_build_number
    commit_version_bump(
      xcodeproj: "Transitions.xcodeproj",
      message: "Bump build to #{version} (build #{build})"
    )
  end
end
